# Blog-Project

## 프로젝트 간단 소개

Next.js 를 활용한 블로그 프로젝트로 회원가입을 통한 좋아요 및 북마크 기능 및 프로젝트 소유자에 한하여 에디터 기능을 제공하는 형태로 고도화를 하였습니다. 기존 프로토타입의 블로그에서는 Firebase를 활용하여 데이터를 관리하였으나 고도화를 하면서 Next.js의 서버 기능과 Sanity(CMS)를 활용하여 Firebase를 대체하였습니다.

## 배포

프로토타입 : https://soyeah-log.vercel.app/ (추후 폐쇄 예정)<br/>
프로덕션 : https://soyeah-blog.vercel.app/

### 실행 방법

```
$ yarn build && yarn start
```

### 구현 기능

- Next.js 와 Sanity를 활용한 Data 관리
- NextAuth 를 활용한 카카오/구글 OAuth 회원가입 및 로그인
- 로그인 정보를 기반으로 한 북마크 및 좋아요 기능
- 페이지 로드를 기반으로 한 포스트 조회 수
- SWR을 활용하여 데이터 패칭 및 좋아요, 북마크 등 서버 데이터에 따른 느린 UI 변화에 대해 OptimisticData 를 활용해 대응
- Toast UI 에디터 내 Base64 기반 사진 업로드를 Sanity CDN을 활용한 URL업로드로 변경
- 로컬 스토리지를 활용한 작성 중 포스트 임시저장 기능
- 디바운스를 적용한 검색 기능

---

### 추가 구현 예정 기능 (1.0.0 버전)

- 댓글 기능
- 모바일/태블릿 대응을 위한 반응형 UI
- 필터
- 페이지네이션
- 커스텀 뷰어 CSS
- 인기 포스트
- 리팩토링

---

## Lighthouse 최적화 점수

![라이트하우스 점수](./public/images/lighthouse-score.png)

---

## 주요 기능 소개 및 GIF

### 소셜 로그인/로그아웃

Nextauth를 활용하여 구현한 OAuth 간편 로그인입니다. 카카오와 구글 두가지의 계정을 활용했으며, 오너 계정이냐 아니냐에 따라서 노출되는 메뉴가 다릅니다.

![구글 및 카카오 로그인 로그아웃](./public/images/login-out.gif)

### 북마크와 좋아요

로그인 후 좋아요나 북마크를 누를 수 있으며, 좋아요의 경우는 추후 인기 게시글 구현을 위해 수집되게 되고, 북마크는 각 아이디 별로 개인화된 북마크 페이지를 확인할 수 있도록 했습니다. 또한 서버에서 데이터가 돌아오는 데까지 시간이 소요되어 클라이언트에는 즉각적으로 UI변경이 일어날 수 없다는 점때문에 SWR의 optimistic data 기능을 활용해 UI가 서버의 데이터를 불러들이는 것과는 상관없이 즉각적으로 변경될 수 있도록 했습니다.

![북마크 및 좋아요](./public/images/bookmarks.gif)

### 에디터

Toast UI Editor를 활용하였으며, 기존 BASE64로 업로드되는 이미지 업로드 로직을 제거하고 Sanity를 통해 CDN서버에 저장한 후 URL을 반환할 수 있도록 로직을 작성해 적용하였습니다. 또한 로컬스토리지를 활용한 임시저장 기능을 만들어 불가피하게 포스트를 마무리 하지 못했을 때 저장할 수 있도록 하였습니다.
UX/UI는 Velog의 에디터을 모티브로 하여 제작되었으며, 모달을 활용해 description과 thumbnail을 추가 작성할 수 있도록 하였습니다.

![URL이미지 업로드 및 임시저장 등 에디터 기능](./public/images/editor.gif)

### 포스팅

CMS 서비스인 Sanity를 활용해 기존 사용하던 파이어베이스를 대체하였습니다. 포스팅 시에는 살짝의 딜레이는 있으나 데이터를 받아오면 클라이언트에서 렌더링할 수 있도록 SSR페이지로 포스트 페이지를 구성했습니다. 조회수와 좋아요 등도 포스트탭에서 업데이트 되어 보이도록 하였습니다.

![포스팅 기능 영상](./public/images/posting.gif)

### 검색 기능

입력되는 키워드에 따라 서버에서 DB에 데이터를 요청할 때 검색결과에 해당하는 값을 불러들이도록 하는 간단한 로직을 적용한 검색 기능입니다. 디바운싱을 통해 불필요한 API요청을 방지하도록 하였습니다.

![디바운싱이 적용된 검색기능](./public/images/search.gif)

---

## 스택 선정 사유

1. Next.js 13버전

- 이전 방식에 비해 급격한 러닝커브로 말이 많은 13버전이지만 페이지 단위로 렌더링 방식이 결정되던 12버전과는 다르게 컴포넌트 단위로 렌더링 방식을 정할 수 있다는 점에서 매력적으로 다가왔습니다.
- 더불어 React 18버전의 RSC나 Suspense 같은 새로운 문법 혹은 기능들을 대거 제공해 새로운 기술들을 경험해보기 좋다는 장점 또한 있었습니다.

2. SWR

- 로그인 정보 관리나 DB에서 데이터를 받아올 때 클라이언트에서 데이터를 관리하는 것보다 SWR과 같은 실시간 상태를 반영할 수 있는 서버 상태 관리 라이브러리 사용이 필요할 것 같다고 판단했습니다. 대표적인 React-Query를 사용하지 않은 이유는 GET요청만 필요하기 때문에 더 가벼운 SWR을 택했습니다.
- 또한 React-Query와 마찬가지로 Optimistic UI 와 같이 좋은 UX를 위한 기능을 제공한다는 점도 사용 이유 였습니다.

3. Sanity

- Firebase의 낮은 일일 트래픽 제공량을 타개할 방안을 찾았고, 접근성이 좋은Headless
  CMS 중 Sanity의 공식문서가 비교적 친절하다는 점 그리고 월마다 갱신되는 트래픽 제공
  량으로 부담없이 사용할 수 있다 판단하여 도입하였습니다.

4. NextAuth.js

- 직접적으로 OAuth 로그인을 구현 하기 보다는 기존 서비스나 라이브러리를 이용하는 편이 효율적이라고 판단하여 여러가지 솔루션을 고려하던 중 가장 대중적으로 많이 쓰이고 사용법도 간편한 NextAuth를 선택하였습니다. Google 뿐 아니라 네이버나 카카오 같은 소셜 로그인도 지원된다는 점도 매력으로 다가왔습니다.

---

## 프로젝트를 진행하며 느낀 점

[[블로그 고도화 회고] 한 서비스를 필요에 의해 만들며 느낀 것들과 트러블 슈팅](https://soyeah-blog.vercel.app/posts/31SgN7qkpPCqZsKHAC3gUJ)

---

## 버전

v0.0.1(MVP. 2023-04-12)

> 초기 동작 모델

v0.0.2(2023-04-20)

> Viewer CSS 수정

v0.0.3(2023-04-20)

> Contact Page 삭제 <br/>
> Contact 요소는 메인 화면으로 가지고 옴 <br/>

v0.0.4(2023-04-20)

> 반응형 일부 수정<br/>
> 로고 반응형 추가<br/>
> post 1024px 사이즈 대응<br/>

0.1.0(2023-07-11)

> 소셜 로그인 기능을 기반으로 한 북마크 및 좋아요 <br/>
> 페이지 로드를 기반으로 한 포스트 조회 수 <br/>
> 로컬스토리지를 활용한 포스트 임시저장 기능 <br/>
> Firebase -> Sanity로 DB 이전 <br/>
> 현재 반응형 미구현 상태로 추가로 구현 예정 <br/>
> 기존 에디터 BASE64 기반 이미지 업로드를 URL기반 업로드로 변경 <br/>

---
